import{u as O,a as W,b,c as A,d as D,r as T,j as e,B as h,C as j,e as B,G as o,T as i,L as K,H as q,f as H,A as P,g as U,E as G,h as z,i as I}from"./index-598b4a4a.js";function R(n){switch(n.code){case"ERR_NETWORK":return I;case"ERR_BAD_RESPONSE":return z;case"ERR_BAD_REQUEST":return"Syöttämäsi sähköposti on jo rekisteröity. Kirjaudu sisään";default:return G}}function M(){const n=O(),l=W(),c=b(),{mutate:E,isLoading:S,error:d,variables:t}=A(),{mutate:_,isLoading:v,error:m}=D(),[N,L]=T.useState(!1),u=d||void 0,x=m||void 0,w=async r=>{var a,g,p,f;r.preventDefault();const s=new FormData(r.currentTarget);E({first_name:(a=s.get("first_name"))==null?void 0:a.toString(),last_name:(g=s.get("last_name"))==null?void 0:g.toString(),email:(p=s.get("email"))==null?void 0:p.toString(),password:(f=s.get("password"))==null?void 0:f.toString()},{onSuccess(){L(!0)},onError(F){console.error(F)}})},y=()=>{const r={email:t==null?void 0:t.email,password:t==null?void 0:t.password};_({email:r.email,password:r.password},{onSuccess(s){var a;n.setUser(s),sessionStorage.setItem("user_data",JSON.stringify(s)),(a=c.state)!=null&&a.from?l(c.state.from,{replace:!0}):l("/dashboard",{replace:!0})}})},C=e.jsxs(e.Fragment,{children:[e.jsxs("h2",{className:"text-center mt-6",children:["Hei, ",t==null?void 0:t.first_name," rekisteröinti onnistui"]}),e.jsx("div",{className:"m-4 text-error-main text-center",children:x?e.jsx("p",{children:R(x)}):void 0}),e.jsx(h,{variant:"contained",fullWidth:!0,onClick:y,children:v?e.jsx(j,{color:"info"}):"Kirjaudu sisään"})]}),k=e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"m-4 text-error-main text-center",children:u?e.jsx("p",{children:R(u)}):void 0}),e.jsxs(B,{component:"form",onSubmit:w,children:[e.jsxs(o,{container:!0,gap:2,children:[e.jsx(o,{item:!0,xs:!0,children:e.jsx(i,{color:"info",autoComplete:"given-name",name:"first_name",required:!0,fullWidth:!0,id:"first_name",label:"First Name",autoFocus:!0})}),e.jsx(o,{item:!0,xs:!0,children:e.jsx(i,{color:"info",required:!0,fullWidth:!0,id:"last_name",label:"Last Name",name:"last_name",autoComplete:"family-name"})})]}),e.jsx(i,{color:"info",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Sähköposti",name:"email",autoComplete:"email",autoFocus:!0}),e.jsx(i,{color:"info",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Salasana",type:"password",id:"password",autoComplete:"current-password"}),e.jsx(h,{type:"submit",fullWidth:!0,variant:"contained",size:"large",sx:{mt:3,mb:2},children:S?e.jsx(j,{color:"info"}):"Rekisteröidy"}),e.jsx("div",{className:"text-center",children:e.jsx(K,{to:"/login",replace:!0,className:"text-info-main",children:"Onko jo tili olemassa? Kirjaudu sisään."})})]})]});return e.jsxs(e.Fragment,{children:[e.jsx(q,{}),e.jsx("main",{children:e.jsx(H,{component:"section",maxWidth:"xs",className:"mt-6",children:e.jsxs("div",{className:"flex flex-col items-center p-2",children:[e.jsx(P,{sx:{m:1,bgcolor:"secondary.dark"},children:e.jsx(U,{})}),N?C:k]})})})]})}export{M as default};
