import{y as B,H as R,J as F,r as t,j as s,m as j,I as W,B as _,E as z,x as A,T as r,W as q}from"./index-nQFFAt2i.js";import{L as M}from"./logo-9c5ToLA2.js";import{d as U,a as D,v as G}from"./test-password-A32DOsyd.js";import{u as H,T as J,L as l}from"./LoadingButton-nbMB_GQd.js";import{I as K}from"./InputAdornment-O14RqhdT.js";import{C as O}from"./Card-QkZeCVK7.js";import"./Link-xj30OAaA.js";import"./Select-bwqtkRDL.js";function $(){var m,p,x,g;const v=B(),d=H(),[k]=R(),{mutate:w,isLoading:b,isSuccess:u}=F(),a=t.useRef(),[n,y]=t.useState(!1),[S,c]=t.useState(""),[h,C]=t.useState(!1),[o,P]=t.useState({reset_token:k.get("reset_token"),password:""}),[i,V]=t.useState({password:!1}),E=e=>{e.target.name==="password"&&(G(a.current.elements.password.value)?e.target.setCustomValidity(""):e.target.setCustomValidity("Salasanan on oltava vähintään 8 merkkiä pitkä ja siinä on oltava vähintään yksi iso ja pieni kirjain sekä numero.")),P({...o,[e.target.name]:e.target.value})},L=e=>{V({...i,[e.target.name]:!0})},I=e=>{e.preventDefault(),a.current.checkValidity()&&w(o,{onError:f=>{if(!f.response)return c("Tarkista verkkoyhteytesi");switch(f.response.status){case 401:C(!0);break;default:c("Oho, jokin meni vikaan");break}}})},T=s.jsx("form",{noValidate:!0,onSubmit:I,ref:a,children:s.jsxs(j,{spacing:3,children:[s.jsx(J,{name:"password",type:n?"text":"password",label:"Uusi salasana",autoComplete:"new-password",required:!0,error:!!(i.password&&((p=(m=a.current)==null?void 0:m.elements.password)!=null&&p.validationMessage)),helperText:i.password&&((g=(x=a.current)==null?void 0:x.elements.password)==null?void 0:g.validationMessage),InputLabelProps:{required:!1},value:o.password,onChange:E,onBlur:L,InputProps:{endAdornment:s.jsx(K,{position:"end",children:s.jsx(W,{onClick:()=>y(!n),edge:"end",children:n?s.jsx(U,{}):s.jsx(D,{})})})}}),s.jsx(l,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"success",loading:b,children:"Vaihda"})]})});return s.jsxs(_,{sx:{...z({color:A(v.palette.background.default,.9),imgUrl:"/assets/background/overlay_4.jpg"}),height:1},children:[s.jsx(M,{sx:{position:"fixed",top:{xs:16,md:24},left:{xs:16,md:24}}}),s.jsx(j,{alignItems:"center",justifyContent:"center",sx:{height:1},children:s.jsxs(O,{sx:{p:5,width:1,maxWidth:420},children:[s.jsx(r,{variant:"h4",children:"Vaihda salasana"}),s.jsx(r,{variant:"body1",color:"error",sx:{mb:5},children:S}),h&&s.jsxs(s.Fragment,{children:[s.jsx(r,{variant:"h5",color:"error",sx:{mt:2,mb:5},children:"Pääsytunnuksen vahvistus epäonnistui. Linkki on voinut vanhentua."}),s.jsx(l,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"inherit",onClick:()=>{d.push("/forgot-password")},children:"Lähetä uusi linkki"})]}),!h&&!u&&T,u&&s.jsxs(s.Fragment,{children:[s.jsx(r,{variant:"h5",color:"success",sx:{mt:2,mb:5},children:"Salasanasi on nyt vaihdettu!"}),s.jsx(l,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"success",onClick:()=>{d.push("/login")},children:"Kirjaudu sisään"})]})]})})]})}function as(){return s.jsxs(s.Fragment,{children:[s.jsx(q,{children:s.jsx("title",{children:" Salasanan nollaus | SE-AS "})}),s.jsx($,{})]})}export{as as default};
