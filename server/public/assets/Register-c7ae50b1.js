import{u as F,R as O,T,r as b,j as e,U as j,C as h,L as A,V as D,W as B,X as K}from"./index-61a7dcf4.js";import{b as q,a as U,B as H,G as n,T as i,C as P,A as G,d as z}from"./useAuthenticate-c6a4ce27.js";import{H as I}from"./Header-e82cbb85.js";import"./Grow-3ef76a1b.js";import"./axios-b8a0d269.js";function R(o){switch(o.code){case"ERR_NETWORK":return K;case"ERR_BAD_RESPONSE":return B;case"ERR_BAD_REQUEST":return"Syöttämäsi sähköposti on jo rekisteröity. Kirjaudu sisään";default:return D}}function Z(){const o=F(),l=O(),c=T(),{mutate:E,isLoading:S,error:m,variables:t}=q(),{mutate:_,isLoading:v,error:d}=U(),[N,L]=b.useState(!1),u=m||void 0,x=d||void 0,w=async r=>{var a,p,g,f;r.preventDefault();const s=new FormData(r.currentTarget);E({first_name:(a=s.get("first_name"))==null?void 0:a.toString(),last_name:(p=s.get("last_name"))==null?void 0:p.toString(),email:(g=s.get("email"))==null?void 0:g.toString(),password:(f=s.get("password"))==null?void 0:f.toString()},{onSuccess(){L(!0)},onError(k){console.error(k)}})},y=()=>{const r={email:t==null?void 0:t.email,password:t==null?void 0:t.password};_({email:r.email,password:r.password},{onSuccess(s){var a;o.setUser(s),sessionStorage.setItem("user_data",JSON.stringify(s)),(a=c.state)!=null&&a.from?l(c.state.from,{replace:!0}):l("/dashboard",{replace:!0})}})},C=e.jsxs(e.Fragment,{children:[e.jsxs("h2",{className:"text-center mt-6",children:["Hei, ",t==null?void 0:t.first_name," rekisteröinti onnistui"]}),e.jsx("div",{className:"m-4 text-error-main text-center",children:x?e.jsx("p",{children:R(x)}):void 0}),e.jsx(j,{variant:"contained",fullWidth:!0,onClick:y,children:v?e.jsx(h,{color:"info"}):"Kirjaudu sisään"})]}),W=e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"m-4 text-error-main text-center",children:u?e.jsx("p",{children:R(u)}):void 0}),e.jsxs(H,{component:"form",onSubmit:w,children:[e.jsxs(n,{container:!0,gap:2,children:[e.jsx(n,{item:!0,xs:!0,children:e.jsx(i,{color:"info",autoComplete:"given-name",name:"first_name",required:!0,fullWidth:!0,id:"first_name",label:"First Name",autoFocus:!0})}),e.jsx(n,{item:!0,xs:!0,children:e.jsx(i,{color:"info",required:!0,fullWidth:!0,id:"last_name",label:"Last Name",name:"last_name",autoComplete:"family-name"})})]}),e.jsx(i,{color:"info",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Sähköposti",name:"email",autoComplete:"email",autoFocus:!0}),e.jsx(i,{color:"info",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Salasana",type:"password",id:"password",autoComplete:"current-password"}),e.jsx(j,{type:"submit",fullWidth:!0,variant:"contained",size:"large",sx:{mt:3,mb:2},children:S?e.jsx(h,{color:"info"}):"Rekisteröidy"}),e.jsx("div",{className:"text-center",children:e.jsx(A,{to:"/login",replace:!0,className:"text-info-main",children:"Onko jo tili olemassa? Kirjaudu sisään."})})]})]});return e.jsxs(e.Fragment,{children:[e.jsx(I,{}),e.jsx("main",{children:e.jsx(P,{component:"section",maxWidth:"xs",className:"mt-6",children:e.jsxs("div",{className:"flex flex-col items-center p-2",children:[e.jsx(G,{sx:{m:1,bgcolor:"secondary.dark"},children:e.jsx(z,{})}),N?C:W]})})})]})}export{Z as default};
