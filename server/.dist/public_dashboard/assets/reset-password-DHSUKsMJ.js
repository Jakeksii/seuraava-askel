import{y as B,a7 as I,a8 as F,r as a,j as s,m as j,a3 as W,B as _,a4 as z,x as A,T as r,W as q}from"./index-BfWpWL7F.js";import{L as M}from"./logo-DukFvgkb.js";import{d as U,a as D,v as G}from"./test-password-XzoWvYQf.js";import{u as K}from"./use-router-DtbeFjTf.js";import{T as O}from"./TextField-BRBbKomu.js";import{I as $}from"./InputAdornment-ks95hJ9z.js";import{L as l}from"./LoadingButton-CFpTvi8e.js";import{C as H}from"./Card-gokM2s2u.js";import"./Link-B7K0QOWw.js";import"./Select-CO_29znq.js";function J(){var h,p,x,f;const v=B(),d=K(),[k]=I(),{mutate:w,isLoading:b,isSuccess:u}=F(),t=a.useRef(),[n,y]=a.useState(!1),[S,c]=a.useState(""),[m,C]=a.useState(!1),[o,P]=a.useState({reset_token:k.get("reset_token"),password:""}),[i,V]=a.useState({password:!1}),E=e=>{e.target.name==="password"&&(G(t.current.elements.password.value)?e.target.setCustomValidity(""):e.target.setCustomValidity("Salasanan on oltava vähintään 8 merkkiä pitkä ja siinä on oltava vähintään yksi iso ja pieni kirjain sekä numero.")),P({...o,[e.target.name]:e.target.value})},L=e=>{V({...i,[e.target.name]:!0})},T=e=>{e.preventDefault(),t.current.checkValidity()&&w(o,{onError:g=>{if(!g.response)return c("Tarkista verkkoyhteytesi");switch(g.response.status){case 401:C(!0);break;default:c("Oho, jokin meni vikaan");break}}})},R=s.jsx("form",{noValidate:!0,onSubmit:T,ref:t,children:s.jsxs(j,{spacing:3,children:[s.jsx(O,{name:"password",type:n?"text":"password",label:"Uusi salasana",autoComplete:"new-password",required:!0,error:!!(i.password&&((p=(h=t.current)==null?void 0:h.elements.password)!=null&&p.validationMessage)),helperText:i.password&&((f=(x=t.current)==null?void 0:x.elements.password)==null?void 0:f.validationMessage),InputLabelProps:{required:!1},value:o.password,onChange:E,onBlur:L,InputProps:{endAdornment:s.jsx($,{position:"end",children:s.jsx(W,{onClick:()=>y(!n),edge:"end",children:n?s.jsx(U,{}):s.jsx(D,{})})})}}),s.jsx(l,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"success",loading:b,children:"Vaihda"})]})});return s.jsxs(_,{sx:{...z({color:A(v.palette.background.default,.9),imgUrl:"/assets/background/overlay_4.jpg"}),height:1},children:[s.jsx(M,{sx:{position:"fixed",top:{xs:16,md:24},left:{xs:16,md:24}}}),s.jsx(j,{alignItems:"center",justifyContent:"center",sx:{height:1},children:s.jsxs(H,{sx:{p:5,width:1,maxWidth:420},children:[s.jsx(r,{variant:"h4",children:"Vaihda salasana"}),s.jsx(r,{variant:"body1",color:"error",sx:{mb:5},children:S}),m&&s.jsxs(s.Fragment,{children:[s.jsx(r,{variant:"h5",color:"error",sx:{mt:2,mb:5},children:"Tunnuksen vahvistus epäonnistui. Linkki on voinut vanhentua."}),s.jsx(l,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"inherit",onClick:()=>{d.push("/forgot-password")},children:"Lähetä uusi linkki"})]}),!m&&!u&&R,u&&s.jsxs(s.Fragment,{children:[s.jsx(r,{variant:"h5",color:"success",sx:{mt:2,mb:5},children:"Salasanasi on nyt vaihdettu!"}),s.jsx(l,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"success",onClick:()=>{d.push("/login")},children:"Kirjaudu sisään"})]})]})})]})}function ns(){return s.jsxs(s.Fragment,{children:[s.jsx(q,{children:s.jsx("title",{children:" Salasanan nollaus | SE-AS "})}),s.jsx(J,{})]})}export{ns as default};
