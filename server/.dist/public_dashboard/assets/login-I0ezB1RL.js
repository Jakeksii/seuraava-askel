import{y as M,a2 as O,A as F,r as n,j as e,m as b,a3 as K,B as W,a4 as _,x as z,T as l,W as U,E as D}from"./index-B3jCW4Fb.js";import{d as G,a as $,v as H}from"./test-password-BKLwSutS.js";import{u as J}from"./use-router-CH7-W6vm.js";import{L as N}from"./logo-_6u3cJ9y.js";import{T as y}from"./TextField-DQCyuwm7.js";import{I as Q}from"./InputAdornment-dOG2pP4o.js";import{L as X}from"./LoadingButton-DudZCK5P.js";import{C as Y}from"./Card-DW1bMlw1.js";import{L as w}from"./Link-DzaUqRWn.js";import"./Select-Br8NO0KB.js";import"./react-is.production.min-DUDD-a5e.js";function Z(){var p,h,x,g,f,j,k,v;const S=M(),d=J(),{mutate:C,isLoading:L}=O(),{setSession:V,switchOrganization:E}=F(),t=n.useRef(),[u,B]=n.useState(!1),[I,i]=n.useState(""),[o,T]=n.useState({email:"",password:""}),[r,P]=n.useState({email:!1,password:!1}),m=s=>{s.target.name==="password"&&(H(t.current.elements.password.value)?s.target.setCustomValidity(""):s.target.setCustomValidity("Salasanan on oltava vähintään 8 merkkiä pitkä ja siinä on oltava vähintään yksi iso ja pieni kirjain sekä numero.")),T({...o,[s.target.name]:s.target.value})},c=s=>{P({...r,[s.target.name]:!0})},A=s=>{s.preventDefault(),localStorage.clear(),E(),t.current.checkValidity()&&C(o,{onSuccess:a=>{V(a),localStorage.setItem("token",a.token);const q=a.user.verified?"/":"/verify-email";d.push(q)},onError:a=>{if(!a.response)return i("Tarkista verkkoyhteytesi");switch(a.response.status){case 400:i("Väärä sähköposti tai salasana.");break;case 429:i("Olet yrittänyt liian monta kertaa. Odota hetki ja yritä uudestaan.");break;default:i("Oho, jokin meni vikaan.");break}}})},R=e.jsx("form",{noValidate:!0,onSubmit:A,ref:t,children:e.jsxs(b,{spacing:3,children:[e.jsx(y,{name:"email",type:"email",label:"Sähköposti",required:!0,error:!!(r.email&&((h=(p=t.current)==null?void 0:p.elements.email)!=null&&h.validationMessage)),helperText:r.email&&((g=(x=t.current)==null?void 0:x.elements.email)==null?void 0:g.validationMessage),InputLabelProps:{required:!1},value:o.email,onChange:m,onBlur:c}),e.jsx(y,{name:"password",type:u?"text":"password",label:"Salasana",required:!0,error:!!(r.password&&((j=(f=t.current)==null?void 0:f.elements.password)!=null&&j.validationMessage)),helperText:r.password&&((v=(k=t.current)==null?void 0:k.elements.password)==null?void 0:v.validationMessage),InputLabelProps:{required:!1},value:o.password,onChange:m,onBlur:c,InputProps:{endAdornment:e.jsx(Q,{position:"end",children:e.jsx(K,{onClick:()=>B(!u),edge:"end",children:u?e.jsx(G,{}):e.jsx($,{})})})}}),e.jsx(X,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"success",loading:L,children:"Kirjaudu"})]})});return e.jsxs(W,{sx:{..._({color:z(S.palette.background.default,.9),imgUrl:"/assets/background/overlay_4.jpg"}),height:1},children:[e.jsx(N,{sx:{position:"fixed",top:{xs:16,md:24},left:{xs:16,md:24}}}),e.jsx(b,{alignItems:"center",justifyContent:"center",sx:{height:1},children:e.jsxs(Y,{sx:{p:5,width:1,maxWidth:420},children:[e.jsx(l,{variant:"h4",children:"Kirjaudu sisään"}),e.jsxs(l,{variant:"body2",sx:{mt:2,mb:2},children:["Ei käyttäjää?",e.jsx(w,{variant:"subtitle2",component:"button",sx:{ml:.5},onClick:()=>{d.push("/register")},children:"Rekisteröidy"})]}),e.jsx(l,{variant:"body1",color:"error",sx:{mb:5},children:I}),R,e.jsx(l,{variant:"body2",sx:{mt:2,mb:2,textAlign:"right"},children:e.jsx(w,{sx:{ml:.5},component:"button",onClick:()=>{d.push("/forgot-password")},children:"Unohtuiko salasana?"})})]})})]})}function me(){return e.jsxs(e.Fragment,{children:[e.jsx(U,{children:e.jsx("title",{children:" Kirjaudu "})}),e.jsx(D,{children:e.jsx(Z,{})})]})}export{me as default};
