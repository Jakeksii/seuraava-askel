import{y as M,a2 as O,A as F,r as i,j as e,m as b,a3 as K,B as W,a4 as _,x as z,T as l,W as U}from"./index-BfR9Iyc6.js";import{d as D,a as G,v as $}from"./test-password-6wPsOSw-.js";import{u as H}from"./use-router-Bwzd77_m.js";import{L as J}from"./logo-BF6DuBGE.js";import{T as y}from"./TextField-CKmx63Kb.js";import{I as N}from"./InputAdornment-1apjz5J0.js";import{L as Q}from"./LoadingButton-D08xbPUI.js";import{C as X}from"./Card-Dm8i3DpH.js";import{L as w}from"./Link-Cp_zJvhJ.js";import"./Select-aOBqE9Cw.js";function Y(){var p,h,x,g,f,j,k,v;const S=M(),d=H(),{mutate:C,isLoading:L}=O(),{setSession:V,switchOrganization:E}=F(),t=i.useRef(),[u,I]=i.useState(!1),[T,n]=i.useState(""),[o,B]=i.useState({email:"",password:""}),[r,P]=i.useState({email:!1,password:!1}),m=s=>{s.target.name==="password"&&($(t.current.elements.password.value)?s.target.setCustomValidity(""):s.target.setCustomValidity("Salasanan on oltava vähintään 8 merkkiä pitkä ja siinä on oltava vähintään yksi iso ja pieni kirjain sekä numero.")),B({...o,[s.target.name]:s.target.value})},c=s=>{P({...r,[s.target.name]:!0})},A=s=>{s.preventDefault(),localStorage.clear(),E(void 0),t.current.checkValidity()&&C(o,{onSuccess:a=>{V(a),localStorage.setItem("token",a.token);const q=a.user.verified?"/":"/verify-email";d.push(q)},onError:a=>{if(!a.response)return n("Tarkista verkkoyhteytesi");switch(a.response.status){case 400:n("Väärä sähköposti tai salasana.");break;case 429:n("Olet yrittänyt liian monta kertaa. Odota hetki ja yritä uudestaan.");break;default:n("Oho, jokin meni vikaan.");break}}})},R=e.jsx("form",{noValidate:!0,onSubmit:A,ref:t,children:e.jsxs(b,{spacing:3,children:[e.jsx(y,{name:"email",type:"email",label:"Sähköposti",required:!0,error:!!(r.email&&((h=(p=t.current)==null?void 0:p.elements.email)!=null&&h.validationMessage)),helperText:r.email&&((g=(x=t.current)==null?void 0:x.elements.email)==null?void 0:g.validationMessage),InputLabelProps:{required:!1},value:o.email,onChange:m,onBlur:c}),e.jsx(y,{name:"password",type:u?"text":"password",label:"Salasana",required:!0,error:!!(r.password&&((j=(f=t.current)==null?void 0:f.elements.password)!=null&&j.validationMessage)),helperText:r.password&&((v=(k=t.current)==null?void 0:k.elements.password)==null?void 0:v.validationMessage),InputLabelProps:{required:!1},value:o.password,onChange:m,onBlur:c,InputProps:{endAdornment:e.jsx(N,{position:"end",children:e.jsx(K,{onClick:()=>I(!u),edge:"end",children:u?e.jsx(D,{}):e.jsx(G,{})})})}}),e.jsx(Q,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"success",loading:L,children:"Kirjaudu"})]})});return e.jsxs(W,{sx:{..._({color:z(S.palette.background.default,.9),imgUrl:"/assets/background/overlay_4.jpg"}),height:1},children:[e.jsx(J,{sx:{position:"fixed",top:{xs:16,md:24},left:{xs:16,md:24}}}),e.jsx(b,{alignItems:"center",justifyContent:"center",sx:{height:1},children:e.jsxs(X,{sx:{p:5,width:1,maxWidth:420},children:[e.jsx(l,{variant:"h4",children:"Kirjaudu sisään"}),e.jsxs(l,{variant:"body2",sx:{mt:2,mb:2},children:["Ei käyttäjää?",e.jsx(w,{variant:"subtitle2",component:"button",sx:{ml:.5},onClick:()=>{d.push("/register")},children:"Rekisteröidy"})]}),e.jsx(l,{variant:"body1",color:"error",sx:{mb:5},children:T}),R,e.jsx(l,{variant:"body2",sx:{mt:2,mb:2,textAlign:"right"},children:e.jsx(w,{sx:{ml:.5},component:"button",onClick:()=>{d.push("/forgot-password")},children:"Unohtuiko salasana?"})})]})})]})}function de(){return e.jsxs(e.Fragment,{children:[e.jsx(U,{children:e.jsx("title",{children:" Kirjaudu | SE-AS "})}),e.jsx(Y,{})]})}export{de as default};
